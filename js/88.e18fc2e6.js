"use strict";(self["webpackChunksanyue_imghub"]=self["webpackChunksanyue_imghub"]||[]).push([[88],{6088:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});var n=a(6023),i=(a(5331),a(8736),a(213),a(5970),a(8785),a(6768));const h={class:"container"};function r(t,e,a,r,s,o){const u=n.o8,d=n.Up;return(0,i.uX)(),(0,i.CE)("div",h,[e[0]||(e[0]=(0,i.Lk)("h1",null,"用户管理",-1)),(0,i.bF)(d,{data:s.dealedData,style:{width:"90%"}},{default:(0,i.k6)((()=>[(0,i.bF)(u,{prop:"ip",label:"IP地址"}),(0,i.bF)(u,{prop:"count",label:"上传次数",sortable:""})])),_:1},8,["data"])])}a(4114),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);var s=a(782),o={name:"UserConfig",data(){return{tableData:[],dealedData:[]}},computed:{...(0,s.L8)(["credentials"])},methods:{async fetchWithAuth(t,e={}){this.credentials&&(e.headers={...e.headers,Authorization:`Basic ${this.credentials}`},e.credentials="include");const a=await fetch(t,e);if(401===a.status)throw this.$message.error("认证状态错误，请重新登录"),this.$router.push("/adminLogin"),new Error("Unauthorized");return a},dealByIP(t){let e=[],a=new Set;return t.forEach((t=>{t.metadata?.UploadIP&&a.add(t.metadata.UploadIP)})),a.forEach((a=>{let n=t.filter((t=>t.metadata?.UploadIP===a)),i=n.length;e.push({ip:a,count:i,data:n})})),e}},mounted(){this.fetchWithAuth("/api/manage/check",{method:"GET"}).then((t=>t.text())).then((t=>{if("true"==t)return this.showLogoutButton=!0,this.fetchWithAuth("/api/manage/list",{method:"GET"});if("Not using basic auth."==t)return this.fetchWithAuth("/api/manage/list",{method:"GET"});throw new Error("Unauthorized")})).then((t=>t.json())).then((t=>{this.tableData=t,this.dealedData=this.dealByIP(t)})).catch((t=>{"Unauthorized"!==t.message&&this.$message.error("同步数据时出错，请检查网络连接")}))}},u=a(1241);const d=(0,u.A)(o,[["render",r]]);var c=d},8736:function(t,e,a){a(5331)},9104:function(t,e,a){a(5331)},5970:function(t,e,a){a(5331)},8785:function(t,e,a){a(5331)},213:function(t,e,a){a(5331),a(9104)}}]);
//# sourceMappingURL=88.e18fc2e6.js.map